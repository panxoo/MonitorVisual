@model ReporteHistoricoInput

@{
ViewData["Title"] = "ReporteHistoricoMonitor";
}

<section class="page-content container-fluid">

    <div class="row">

        <div class="col-12">
            <form method="post" id="FormFilter" asp-controller="SistemaMonitoreo" asp-action="ExportHistMonit">
                <div class="card">
                    <h5 class="card-header">Filtro de busqueda</h5>


                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-md-2">
                                <label asp-for="MonitorId"> </label>
                                <select asp-for="MonitorId" class="form-control">
                                    <option value="-1" selected>Sin Filtrar</option>
                                    @foreach (SelectListItem item in Model.Monitores)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>

                            <div class="form-group col-md-2">
                                <label asp-for="FechaIni"></label>
                                <input type="date" class="form-control" asp-for="FechaIni" autocomplete="off">
                            </div>

                            <div class="form-group col-md-2">
                                <label asp-for="FechaFin"></label>
                                <input type="date" class="form-control" asp-for="FechaFin" autocomplete="off">
                            </div>
                        </div>

                    </div>


                    <div class="card-footer">
                        <input type="button" value="Filtrar" class="btn btn-success" id="btnFilter" onclick="Filtrar()">
                        <input type="submit" value="Exportar" class="btn btn-success" id="btnExport" >
                    
                    </div>
                </div>
            </form>
        </div>

        <div class="col-12">
            <div class="card">
                <h5 class="card-header">Reporte Historico</h5>
                <div class="card-body">
                    <div id="datosMonit">
                        <div class="table-responsive">
                            <partial name="Shared/_ReporteHistoricoMonitorDatos" model="@Model.ReporteHistorials" />
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

</section>


@section Scripts{

<script type="text/javascript">
 
 
    function Filtrar(){
       
        let post = new AjaxSubmit('@Url.Action("ReporteHistoricoMonitorFilter", "SistemaMonitoreo")', "#btnFilter", "Error en obtener datos");
        post.partial = "#datosMonit";
        post.tablereload = "#bs4-table";
        
        dt={
            fechaIni: $("#FechaIni").val(), 
            fechaFin: $("#FechaFin").val(), 
            id: $("#MonitorId").val()  
        };

        post.ObtenerDatos(dt);      
    }

    $("#AjaxFormRepHistEdit").submit(function (e) {
e.preventDefault();


            let post = new AjaxSubmit('@Url.Action("MantenedorMonitoresEdit", "SistemaMonitoreo")', "#SubmitBtn", "Error almacenamiento");
            post.btnCancel = "#btnCancel";
            post.partial = "#MonitoresMant";

            dt = ObtenerDatos();
            post.AjaxPop(dt);

    });

    function ObtenerDatos()
    {
        let moni =[];


            $.each($("#LstAreAtencionHrMeEd").find(":checkbox"), function () {
                if ($("#" + this.id).prop('checked'))
                    arat.push(this.id);
            });

    }


</script>
}